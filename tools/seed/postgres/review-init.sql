-- Review Service Database Schema + Seed Data

CREATE TABLE IF NOT EXISTS reviews (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    product_id UUID NOT NULL,
    user_id UUID NOT NULL,
    rating INTEGER NOT NULL CHECK (rating BETWEEN 1 AND 5),
    title VARCHAR(200),
    content TEXT NOT NULL,
    size_feedback VARCHAR(20), -- 'SMALL', 'TRUE_TO_SIZE', 'LARGE'
    quality_rating INTEGER CHECK (quality_rating BETWEEN 1 AND 5),
    verified_purchase BOOLEAN DEFAULT false,
    helpful_count INTEGER DEFAULT 0,
    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_reviews_product ON reviews(product_id);
CREATE INDEX idx_reviews_rating ON reviews(rating);
CREATE INDEX idx_reviews_verified ON reviews(verified_purchase);
CREATE INDEX idx_reviews_content_search ON reviews USING gin(to_tsvector('simple', content));

-- ============================================================
-- Seed Reviews (Korean, realistic)
-- ============================================================

INSERT INTO reviews (product_id, user_id, rating, title, content, size_feedback, quality_rating, verified_purchase, helpful_count) VALUES
-- 오버핏 코튼 티셔츠 리뷰
('b1000000-0000-0000-0000-000000000001', 'u1000000-0000-0000-0000-000000000001', 5, '가성비 최고', '이 가격에 이 퀄리티는 진짜 말이 안 됩니다. 세탁 3번 했는데 늘어남 없고 색빠짐도 없어요. 오버핏이라 M 사이즈 추천합니다. 175/65 기준 M 딱 좋아요.', 'TRUE_TO_SIZE', 5, true, 42),
('b1000000-0000-0000-0000-000000000001', 'u1000000-0000-0000-0000-000000000002', 4, '괜찮은 티셔츠', '무난하게 입기 좋아요. 다만 화이트 색상은 약간 비침이 있어서 이너 필요합니다. 사이즈는 넉넉한 편.', 'LARGE', 4, true, 18),
('b1000000-0000-0000-0000-000000000001', 'u1000000-0000-0000-0000-000000000003', 3, '보통이에요', '가격 대비 적당해요. 근데 목 부분이 좀 늘어나는 감이 있습니다. 보풀도 조금 생기네요.', 'TRUE_TO_SIZE', 3, true, 8),

-- 슬림핏 옥스포드 셔츠 리뷰
('b1000000-0000-0000-0000-000000000002', 'u1000000-0000-0000-0000-000000000004', 5, '출근용으로 완벽', '비즈니스 캐주얼에 딱이에요. 구김도 적고 핏도 예쁩니다. 180/72 L 입었는데 팔 길이도 딱 맞아요.', 'TRUE_TO_SIZE', 5, true, 35),
('b1000000-0000-0000-0000-000000000002', 'u1000000-0000-0000-0000-000000000005', 4, '핏이 예뻐요', '슬림핏이라 몸에 붙는 느낌인데 불편하지 않아요. 다만 팔이 긴 분들은 한 사이즈 업 추천.', 'SMALL', 4, true, 22),

-- 캐시미어 블렌드 니트 리뷰
('b1000000-0000-0000-0000-000000000003', 'u1000000-0000-0000-0000-000000000006', 5, '부드럽고 따뜻해요', '캐시미어 비율이 높아서 촉감이 좋아요. 보풀도 거의 안 생기고 세탁도 편합니다. 170/60 M 착용.', 'TRUE_TO_SIZE', 5, true, 29),
('b1000000-0000-0000-0000-000000000003', 'u1000000-0000-0000-0000-000000000007', 4, '색감이 좋아요', '사진과 실물 색감 차이 없고 고급스러워요. 약간 짧은 느낌이 있어서 키 큰 분은 사이즈 업.', 'SMALL', 4, true, 15),

-- 스트레이트 데님 리뷰
('b1000000-0000-0000-0000-000000000004', 'u1000000-0000-0000-0000-000000000008', 5, '리바이스는 역시', '핏이 진짜 예쁩니다. 원단도 두껍지 않아 사계절 가능. 30 사이즈 허리 딱 맞아요. 175/68 기준.', 'TRUE_TO_SIZE', 5, true, 48),
('b1000000-0000-0000-0000-000000000004', 'u1000000-0000-0000-0000-000000000009', 3, '허리가 좀 큽니다', '길이는 좋은데 허리가 넉넉해요. 한 사이즈 다운 추천. 원단 질감은 좋습니다.', 'LARGE', 3, true, 12),

-- 경량 패딩 리뷰
('b1000000-0000-0000-0000-000000000006', 'u1000000-0000-0000-0000-000000000010', 5, '가볍고 따뜻해요', '무게가 거의 안 느껴지는데 보온성은 확실해요. 파우치에 넣으면 가방에 쏙 들어가서 좋습니다.', 'TRUE_TO_SIZE', 5, true, 55),
('b1000000-0000-0000-0000-000000000006', 'u1000000-0000-0000-0000-000000000011', 4, '등산할 때 좋아요', '아우터 안에 레이어드하기 좋은 두께입니다. 바람이 좀 들어오긴 하지만 무게 대비 훌륭합니다.', 'TRUE_TO_SIZE', 4, true, 23),

-- 갤럭시 S24 Ultra 리뷰
('b1000000-0000-0000-0000-000000000008', 'u1000000-0000-0000-0000-000000000012', 5, 'AI 기능이 미쳤어요', '통역 기능이랑 사진 편집 AI가 진짜 편합니다. 배터리도 하루 종일 쓰고도 남아요. 카메라 성능은 말할 것도 없고요.', NULL, 5, true, 88),
('b1000000-0000-0000-0000-000000000008', 'u1000000-0000-0000-0000-000000000013', 4, '무겁지만 좋아요', '234g이라 좀 무겁긴 한데 성능은 압도적이에요. S펜도 유용합니다. 가격이 좀 부담되지만 후회 없어요.', NULL, 4, true, 45),

-- 아이폰 15 Pro 리뷰
('b1000000-0000-0000-0000-000000000009', 'u1000000-0000-0000-0000-000000000014', 5, '티타늄 디자인 최고', '가볍고 고급스러워요. 카메라 특히 동영상 촬영이 좋습니다. 에어팟이랑 맥북이랑 연동 완벽.', NULL, 5, true, 72),
('b1000000-0000-0000-0000-000000000009', 'u1000000-0000-0000-0000-000000000015', 4, '만족합니다', '안드로이드에서 넘어왔는데 적응하면 편해요. 다만 충전 속도가 아쉽고 가격 대비 용량이 적습니다.', NULL, 4, true, 33),

-- 에어팟 프로 2 리뷰
('b1000000-0000-0000-0000-000000000012', 'u1000000-0000-0000-0000-000000000016', 5, '노이즈 캔슬링 최강', '지하철에서 완전 조용해집니다. 통화 품질도 좋고 음질은 이어폰 중에서 최고급은 아니지만 충분해요.', NULL, 5, true, 61),
('b1000000-0000-0000-0000-000000000012', 'u1000000-0000-0000-0000-000000000017', 3, '귀가 좀 아파요', '2시간 이상 착용하면 귀가 아프네요. 이어팁 바꾸면 나아질 수도 있지만 개인차가 있을 것 같아요.', NULL, 3, true, 28),

-- 에어포스 1 리뷰
('b1000000-0000-0000-0000-000000000015', 'u1000000-0000-0000-0000-000000000018', 5, '클래식은 이유가 있다', '어떤 옷에도 다 어울려요. 발볼 넓은 편이라 평소 사이즈 추천. 270 신었는데 딱 맞아요.', 'TRUE_TO_SIZE', 5, true, 39),
('b1000000-0000-0000-0000-000000000015', 'u1000000-0000-0000-0000-000000000019', 4, '무거운 게 단점', '디자인은 완벽한데 좀 무거워요. 오래 걸으면 발이 피로해질 수 있어요. 반사이즈 업 추천합니다.', 'SMALL', 4, true, 21),

-- 뉴발란스 530 리뷰
('b1000000-0000-0000-0000-000000000016', 'u1000000-0000-0000-0000-000000000020', 5, '쿠셔닝이 좋아요', '오래 걸어도 발이 편합니다. 디자인도 레트로해서 예쁘고 활용도 높아요. 정사이즈 추천.', 'TRUE_TO_SIZE', 5, true, 44),

-- WH-1000XM5 리뷰
('b1000000-0000-0000-0000-000000000014', 'u1000000-0000-0000-0000-000000000021', 5, '헤드폰의 끝판왕', '노이즈 캔슬링이 미쳤어요. 비행기에서 엔진소리가 안 들려요. 음질도 하이레졸 지원하고 배터리도 30시간.', NULL, 5, true, 92),
('b1000000-0000-0000-0000-000000000014', 'u1000000-0000-0000-0000-000000000022', 4, '가격 빼면 완벽', '성능은 인정하는데 40만원이 좀 부담됩니다. 그래도 쓰면 쓸수록 만족도 올라가요. 접히지 않는 건 아쉬워요.', NULL, 4, true, 37);
